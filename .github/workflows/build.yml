name: Build and Test

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

# IMPORTANT: This workflow does NOT produce downloadable binaries.
# Pre-built binaries are available exclusively through BuyMeACoffee:
# https://buymeacoffee.com/opentweak
#
# See LICENSE.md and docs/DISTRIBUTION.md for terms.
# Automated build services that distribute binaries are PROHIBITED.

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v4
      with:
        fetch-depth: 0

    - name: Setup .NET
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '8.0.x'

    - name: Restore dependencies
      run: dotnet restore

    - name: Build
      run: dotnet build --configuration Release --no-restore

    - name: Test
      run: dotnet test --no-restore --verbosity normal

    # Note: We intentionally do NOT publish or upload artifacts.
    # This prevents automated distribution of binaries.
    # Users must either:
    #   1. Build from source (free)
    #   2. Purchase from BuyMeACoffee ($25)
    #
    # See docs/COMMERCIAL.md for full terms.
